### Makefile for the fpu project
### Generated by Bluespec Workstation on Fri Sep  9 19:07:42 IST 2016

default: full_clean compile link simulate check

.PHONY: compile
compile:
	@echo Compiling...
	bsc -u -sim -simdir bsim -bdir intermediate -info-dir bsim -keep-fires -p .:%/Prelude:%/Libraries:%/Libraries/BlueNoC -g mkTb_fpgen  fpu.bsv 
	@echo Compilation finished

.PHONY: link
link:
	@echo Linking...
	bsc -e mkTb_fpgen -sim -o ./out -simdir bsim -p .:%/Prelude:%/Libraries:%/Libraries/BlueNoC -bdir intermediate -keep-fires 
	@echo Linking finished

.PHONY: simulate
simulate:
	@echo Simulation...
	./out 
	@echo Simulation finished

.PHONY: clean
clean:
	exec rm -f intermediate/fpu_sqrt.bo intermediate/integer_divider.bo intermediate/fpu_divider.bo intermediate/fpu_sign_injection.bo intermediate/fpu_fp_to_int.bo intermediate/fpu_fm_add_sub.bo intermediate/fpu_fclass.bo intermediate/fpu_int_to_fp.bo intermediate/defined_types.bo intermediate/integermultiplier.bo intermediate/fpu.bo intermediate/fpu_convert_sp_dp.bo intermediate/fpu_compare_min_max.bo
	exec rm -f intermediate/mkfpu_int_to_fp.ba intermediate/mkTb_fpgen.ba intermediate/mkfpu_convert_sp_dp.ba intermediate/mkfpu.ba

.PHONY: full_clean
full_clean:
	rm -f intermediate/fpu_sqrt.bo intermediate/integer_divider.bo intermediate/fpu_divider.bo intermediate/fpu_sign_injection.bo intermediate/fpu_fp_to_int.bo intermediate/fpu_fm_add_sub.bo intermediate/fpu_fclass.bo intermediate/fpu_int_to_fp.bo intermediate/defined_types.bo intermediate/integermultiplier.bo intermediate/fpu.bo intermediate/fpu_convert_sp_dp.bo intermediate/fpu_compare_min_max.bo
	rm -f intermediate/mkfpu_int_to_fp.ba intermediate/mkTb_fpgen.ba intermediate/mkfpu_convert_sp_dp.ba intermediate/mkfpu.ba
	rm -f bsim/mkfpu_int_to_fp.h
	rm -f bsim/mkfpu_int_to_fp.cxx
	rm -f bsim/model_mkTb_fpgen.h bsim/mkTb_fpgen.h
	rm -f bsim/mkTb_fpgen.cxx bsim/model_mkTb_fpgen.cxx
	rm -f bsim/mkfpu_convert_sp_dp.h
	rm -f bsim/mkfpu_convert_sp_dp.cxx
	rm -f bsim/mkfpu.h
	rm -f bsim/mkfpu.cxx
	rm -rf testcases/RTL_outputs/*

.PHONY: check
check:
	@echo checking results...
	@if ! diff -qr testcases/fpgen_outputs/ testcases/RTL_outputs/ ; then echo "They differ"; else wc -l testcases/fpgen_outputs/*; echo "All testcases passed"; fi 



